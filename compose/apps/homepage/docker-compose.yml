services:
  homepage:
    image: ghcr.io/gethomepage/homepage:latest
    container_name: homepage
    environment:
      HOMEPAGE_ALLOWED_HOSTS: home.${DOMAIN}
      HOMEPAGE_VAR_RADARR_API_KEY: ${RADARR_API_KEY}
      HOMEPAGE_VAR_SONARR_API_KEY: ${SONARR_API_KEY}
      HOMEPAGE_VAR_PROWLARR_API_KEY: ${PROWLARR_API_KEY}
      HOMEPAGE_VAR_BAZARR_API_KEY: ${BAZARR_API_KEY}
      HOMEPAGE_VAR_JELLYSEERR_API_KEY: ${JELLYSEERR_API_KEY}
      HOMEPAGE_VAR_JELLYFIN_API_KEY: ${JELLYFIN_API_KEY}
      HOMEPAGE_VAR_QBITTORRENT_USERNAME: ${QBITTORRENT_USERNAME:-admin}
      HOMEPAGE_VAR_QBITTORRENT_PASSWORD: ${QBITTORRENT_PASSWORD}
      HOMEPAGE_VAR_PIHOLE_API_KEY: ${PIHOLE_API_KEY}
      HOMEPAGE_VAR_UPTIME_KUMA_SLUG: ${UPTIME_KUMA_SLUG:-default}
      HOMEPAGE_VAR_PAPERLESS_API_KEY: ${PAPERLESS_API_KEY}
      HOMEPAGE_VAR_BESZEL_USER: ${BESZEL_USER:-rushil.basappa@gmail.com}
      HOMEPAGE_VAR_BESZEL_PASSWORD: ${BESZEL_PASSWORD}
    volumes:
      - ./config/settings.yaml:/app/config/settings.yaml:ro
      - ./config/services.yaml:/app/config/services.yaml:ro
      - ./config/docker.yaml:/app/config/docker.yaml:ro
      - ./config/bookmarks.yaml:/app/config/bookmarks.yaml:ro
      - ./config/widgets.yaml:/app/config/widgets.yaml:ro
    networks:
      - traefik_public
      - socket_proxy
    deploy:
      resources:
        limits:
          memory: 256M
    labels:
      traefik.enable: "true"
      traefik.http.routers.homepage.rule: "Host(`home.${DOMAIN}`)"
      traefik.http.routers.homepage.entrypoints: websecure
      traefik.http.services.homepage.loadbalancer.server.port: "3000"
      traefik.http.routers.homepage.middlewares: authelia@docker
      kuma.homepage.http.name: Homepage
      kuma.homepage.http.url: https://home.${DOMAIN}
    restart: unless-stopped

networks:
  traefik_public:
    external: true
  socket_proxy:
    external: true
